const rawDataRulesOfficial = [
"77: 30 112 | 20 13",
"121: 43 20 | 123 30" ,
"42: 57 30 | 101 20",
"30: a"     ,
"50: 65 20 | 134 30",
"37: 89 20 | 43 30" ,
"106: 16 30 | 54 20",
"17: 30 84 | 20 35" ,
"129: 89 20 | 96 30",
"123: 30 30 | 20 95",
"20: b"     ,
"115: 20 70 | 30 93",
"112: 30 90 | 20 123" ,
"4: 20 55 | 30 5" ,
"72: 20 90 | 30 123",
"51: 30 20 | 20 95" ,
"24: 131 30 | 7 20" ,
"94: 121 20 | 15 30",
"117: 133 30 | 102 20",
"92: 28 20 | 43 30" ,
"70: 87 30 | 96 20" ,
"88: 109 20 | 36 30",
"35: 20 36 | 30 61" ,
"96: 30 95 | 20 20" ,
"47: 96 20 | 66 30" ,
"6: 20 55 | 30 123" ,
"130: 30 29 | 20 88",
"68: 5 20 | 89 30",
"66: 95 95" ,
"75: 96 30 | 55 20" ,
"3: 20 90 | 30 5" ,
"7: 20 53 | 30 123" ,
"86: 30 5 | 20 53",
"105: 20 87",
"46: 134 20 | 87 30",
"102: 30 111 | 20 103",
"93: 87 20 | 87 30" ,
"79: 116 20 | 71 30",
"8: 42"     ,
"33: 5 20 | 87 30",
"107: 96 20 | 123 30" ,
"90: 20 30" ,
"110: 20 59 | 30 32",
"16: 30 68 | 20 39" ,
"52: 4 20 | 38 30",
"71: 96 30 | 51 20" ,
"38: 96 20 | 90 30" ,
"28: 20 30 | 30 30" ,
"27: 30 64 | 20 24" ,
"91: 30 27 | 20 113",
"1: 20 90 | 30 134" ,
"54: 105 20 | 18 30",
"0: 8 11"   ,
"73: 65 20 | 55 30" ,
"132: 30 17 | 20 19",
"41: 20 51 | 30 22" ,
"45: 22 30 | 53 20" ,
"14: 124 20 | 73 30",
"22: 30 30" ,
"23: 87 30 | 55 20" ,
"10: 30 89 | 20 134",
"120: 56 30 | 9 20" ,
"11: 42 31" ,
"109: 95 134" ,
"127: 30 53 | 20 123" ,
"61: 20 53 | 30 90" ,
"103: 127 30 | 23 20" ,
"116: 90 20 | 87 30",
"134: 20 20 | 30 20",
"114: 20 63 | 30 41",
"64: 20 118 | 30 25",
"12: 30 48 | 20 3",
"111: 20 23 | 30 72",
"60: 79 30 | 120 20",
"59: 20 28 | 30 87" ,
"65: 20 30 | 20 20" ,
"44: 89 30 | 28 20" ,
"18: 65 20 | 43 30" ,
"32: 95 123",
"83: 30 66 | 20 22" ,
"63: 20 123 | 30 55",
"48: 30 134 | 20 43",
"99: 20 12 | 30 125",
"43: 20 20" ,
"133: 20 100 | 30 110",
"80: 20 50 | 30 44" ,
"125: 20 98 | 30 86",
"135: 128 30 | 130 20",
"131: 20 55 | 30 134" ,
"122: 97 30 | 60 20",
"25: 30 43 | 20 51" ,
"95: 20 | 30" ,
"55: 30 95 | 20 30" ,
"13: 43 20 | 43 30" ,
"21: 20 76 | 30 80" ,
"98: 89 30 | 65 20" ,
"81: 106 30 | 85 20",
"53: 30 30 | 20 20" ,
"78: 45 30 | 37 20" ,
"89: 20 30 | 30 20" ,
"9: 96 30 | 43 20",
"31: 2 20 | 82 30",
"56: 5 20 | 96 30",
"76: 1 20 | 23 30",
"62: 92 30 | 10 20" ,
"58: 30 22 | 20 43" ,
"85: 77 20 | 67 30" ,
"26: 30 58 | 20 6",
"101: 30 81 | 20 91",
"29: 83 30 | 47 20" ,
"126: 20 53 | 30 55",
"2: 122 20 | 135 30",
"15: 5 30 | 51 20",
"34: 20 37 | 30 116",
"82: 30 104 | 20 132" ,
"19: 40 20 | 62 30" ,
"108: 21 20 | 119 30" ,
"36: 30 22 | 20 87" ,
"104: 69 30 | 99 20",
"100: 20 7 | 30 61" ,
"39: 89 20" ,
"87: 30 20" ,
"113: 52 30 | 34 20",
"5: 30 30 | 30 20",
"40: 4 30 | 107 20" ,
"97: 20 26 | 30 78" ,
"67: 30 131 | 20 126" ,
"118: 20 134 | 30 66" ,
"124: 96 30 | 22 20",
"128: 30 114 | 20 14" ,
"119: 30 49 | 20 74",
"84: 129 30 | 33 20",
"74: 30 6 | 20 46",
"49: 30 38 | 20 75" ,
"57: 117 30 | 108 20" ,
"69: 20 94 | 30 115"
];

const rawDataRulesExample = [
"0: 4 1 5",
"1: 2 3 | 3 2",
"2: 4 4 | 5 5",
"3: 4 5 | 5 4",
"4: a",
"5: b"
]

const rawDataMessagesOfficial = [
"aaabbaababbababbabaabbbaaabbbbaa",
"baabaabaaaabbabbbbbaaabb",
"aabbbaaabaaaabbbbaabbaaa",
"bababbbabbabbaaaaabababbbbaaaaaaaaabbaabaaaaabababaaabbaababbaab",
"baababbbbbbaaaababaaaababbabbaaaaabbbbbbbabaabaaaaabbbbb",
"abbaaabababbaaaabbaabababbbabbaa",
"aaabaaabaaabaaaaaaabbbab",
"abaaabaabbababababaaabba",
"aabbbbbbaaabbaaaabbabbbb",
"aabbbabaaaababaabbbababb",
"aaabbabbbaabbabbabaabbba",
"bbbaaaabbbabbbaaababbaabaaabaaaabbbbabba",
"babbbbaaaaabaaaabaaababbbabbaabbbaababbaabaaabab",
"aabaaaaabbaaaaaabbababbbbabaaaaabbaaaabb",
"bbbbababaaabbaaaaababbaa",
"baabaaabbbbbababababaabbaaabbabbaabbbaab",
"bbaabbabbbabbbaababbbbbabaabaabbbababababaaabaaa",
"baabbbbbaaaabbbabbbbbbbb",
"bbabbaabbbabbaaabbbaabaabaaabbbbaababaaa",
"babbbaababbbabbababaabbb",
"aabbbbbabbbbaaaabbbaabababababbb",
"aabbabaababababababbaaabaaabaabb",
"aabababbaaaaaaaababbbbaaabaaaaaa",
"abbbababaaabbaabababababbaaabbbbaaabaabb",
"baabbabaaabaaaaabbbbbaabababaaaa",
"abbbbabbbababbababbaabbbbaaaabba",
"abababbababaaabbabaabbbb",
"aaaabbbaaaaaabaabaaabbba",
"bbaabaababaaaabbaaaaaabb",
"aaabbabbaabaabbbaabbaaba",
"aaaaabaabbaabaababbabaaa",
"bbabbbbabbbaabbbabbbbaab",
"aaabbabbbaaabbbbbaabaabbbabababbaaaaaababbbbaabb",
"abaabbabbabaaabababaababaabbabbbabbbbaaaaabbbbaabbaaaaababbbabbaabbbbbabaabaabbabbbbbaabaaaabbab",
"bbbaababaaaabababaaaaaab",
"bbbbabbbaaababbbaabbbbbb",
"babbbaabaababbbaabbbbbaa",
"abababbabbbabbabbbbabaaa",
"abaabaaaaabaabbabaaabbbbbbababab",
"abababbaaabababbbababaaa",
"baaabbabbbbbbabababbaaababbbbabbbaababbbaabbbbabbbaaabbabbbbbbab",
"aababbbaabababaaaaaaabab",
"baaabbababbaaaababbabbbabaaabaaabaabbbbaaabbabaabbbaabbbabbabbabaabbaaab",
"baaaabaabbababbbbbbbbababaaabaab",
"bbabbaababbabaabaaabaaabaaaabbaaabbbbaab",
"bbbaaaaaabbaaaaabaaaaaaa",
"bbabbbaababbbaaaababababbbaabaabbbbbababbaaabbbaabbaaaabbaaaaaaa",
"abbbbabbaabbabbbaaaaabba",
"babbababbaaabbabbabbaabaaaaaaaba",
"bbbbababbababbbbabbababbaaababab",
"abbaaaababbabbbbbabbaaabaababaab",
"aabbbbbbabaabababbbabaaa",
"aaaaaaaababaaabaabaabbaaabbabbbaabaaaaaabbaabbba",
"abbbababaaaaabaaaababbbaaaabbaaa",
"bbbbbabbaabaaaaaaabaabbaaaaabbaa",
"ababbabababbbaabababbbaaabaabbbb",
"ababaabaabbabbbabbbabbbabbaaaababaabbaaa",
"ababaabaaaababbbbaaaabaabababbaaabbababb",
"aaabbbaabaabbbbbbaaababbaaaabbbabbbbbbbb",
"aaababbbaaaabaabbababaab",
"aabbbabaababbbabbaaaabab",
"abaabbbbbbabaabaaababababbbabaabbaabbaabaabababbabbaaaababaaaaaa",
"abbaaaababaaaabaabbbbbabbbaaabaaaabbabaa",
"babaaaaabbbaabababaaabbb",
"abbbbbbaabaabaaabbaaaaaabbabbbaabbabbbbbaabbbbababbababb",
"baabbababbbabbababbbbbaa",
"bbabaababbbabbabaabbbaab",
"ababbbabbbbbabaabaaaaabb",
"babbbbbbbaaaabbbabbbbaba",
"babbabaabaaabbababaababaababaaab",
"aaaababaaaababaaabbbabbaabbaaaabaaaabbab",
"abbaabbbbbabbabbababbbbbbbbabbaabaaaababbbbaabbabaaaabbbbabaaaabaaaabbab",
"baabbbbabaabbbbabaaabaaa",
"aaabbaaaaaabbabaabaaaaab",
"abbabaabbaaababbaabbabab",
"aabaabbbbaababbabbbbbaaabbbaaabb",
"aaaaaaaaaabbabbbaabaaabbabaaabababbbaababbaaabababbbbaaaaaabbbababaaaaaa",
"babbabababaaaababaaaabba",
"abbaaaaaaaabbaaabbbaabaaabaaaabbabaabaaabbbaabbbbbbaabbbbbaabababababaab",
"bbabaababaabbabbbbaaaaba",
"bbabbbaaaabaaabbbbbabbbaaabbbbba",
"babbbaaaaabbaaaababbbabb",
"bababbabbbaabaabbbbaaaaabaabbbab",
"bbbaaaaabababbaabaaaaaab",
"babababbbaabaaaaaaaabbbaabbbabbb",
"aaaaabaabbabbababbaabbba",
"aabababbabbabbaabbbaabbb",
"baaababbaabbaaaaaabbbabb",
"bbaababbaaabbbaababababbaabbaaabaaababab",
"baaaabaaababababaabbabbbabababbaaababbbbbbbaabba",
"babbbbabbbabbababaabaaabbbbaaaabababaaab",
"baaaaabaaabbbbaaabbaabbaabaabbbabababbabbaaabaaaaaabaaababaabbabbabaaaaaaaabbbbb",
"babbbaaaabbbbbbbaaaababbaabbbbbbbbbaaaabbbabbbbabaababaa",
"baabbbbbabababbaabababaabaabaabaaababbbbbbaabbaa",
"babaaababaaaaabaaabaabbabaaabbabbaaaabaabbbaabbbbbabaaabaaaaabbabbbabaab",
"abbabaaababaabaaabaaabaaababbbaababbababbaaabaaababbaaaa",
"ababaabaabbababaaaabbbbb",
"baababbabaabbbbbbbbaabaaababaaabbbbbbbaa",
"aabbaaabbbbababbababbaaa",
"babaabbabbbbbabbabbbbaba",
"abbbabbbbaaababbabaabbaabbbabaaa",
"babbbaaabaaaabaaaaabaaabbaaabbbbbabbaabaabaaabba",
"bbbbabbbbabbaababbabbbbb",
"bbbbaaaabaabbbabbbbabbaaaabbbaab",
"babbbbbababababaaaaabaaa",
"babbaabbbabaabbababaaaab",
"abbbabbabbababbbaabbbbaa",
"aaabbaababbbabbbbbaabaaa",
"babbaabaabaabaaaaaaaaaaabababbba",
"aabaaaababaaaabaababbbababbbababaabababa",
"bbbabbbbaaababbaabbbaaaabbbbbaabbabbbbbaaaabbbbaabbbaabb",
"abbabababbabbaaaabaabbba",
"abbaaaabbaaaabbabbbababaabbbabaa",
"abbaaabbbbaaababbbbaaaabbabbbbbabbbababbaababbab",
"baaababbababaababbbbabaaaabbababbaaabaaa",
"babbaaabbaabbbbbaabaaaaababbabaabaaabaabaabbbabbbabaabaa",
"aaababbbaaaababaababbaab",
"baaaabbbbaabbbaaabbaabbb",
"babbbaabaabbabababaaaaabaabbaabababaabbb",
"abbabbbbabababbababbaabaaaaaaaababbaaabbabbbbbaabbbabbabbbbababb",
"baaabbbbabbbaaaabbbaabba",
"abababaabaabaabbbbbabbbaaaabbababaabbbaabbababab",
"aaaabaababababbaaababbbabbabbaabaabbbbabbbbbbbaaabaaaaaa",
"aabaaabababbbaabbbbbbbaa",
"aabaaaabbaabaaaaaaaaabba",
"babababbaabbbaaaabbaaaba",
"abbabbbaaaababaaaabaaaaaaabbbbbbabaaabbb",
"bbbaaabaaabaababbbbaabba",
"bbabaababbbbbabbaaaababaaabaaaaaabbbbaaabbaabaaa",
"aaaababbbababbababbbbbbaaaabaaaaabbaaabaabbbbbaabababaab",
"baabbbbbaabaaaababbabbaaaaaabaaa",
"bbbbbaabbbbbabaababbbaaabababbbbbbbaaaaaabbbbaba",
"ababbaabaabbaabbaaaabbbb",
"bbbbbaabaabbbbbbbaaaaaaa",
"bbbbbaaabbbbabbbaabaaabbbabaabbb",
"bbbbbaabaaababbaaaabbaaabbbbababbabaabbabbbaaabbaaaaabbb",
"baabbbaabaabbababbababbabaaaabab",
"abaababbabbabbaaababbbba",
"aaabbaababbabababababaaabbabbbbb",
"aaababbbbabbabaaabaabaaabbbbaaba",
"baaababbbabbaaabbaabaaaabbbababb",
"abbbbbbaabbbabbaaabaaaabbbababbbaaabbbab",
"bbbbbababbbaababbababaab",
"aaaababababbbaaaabababbb",
"bbabbaababbababaaabaaababbbbababbbbbbbabbbaaabbb",
"abbbbbbbaabaabbaaabbbaab",
"bbbaababbbbbbaaaaaaabbab",
"babbbbbaaaaababbaaaaaabb",
"baabbbaabaabbababbabbabb",
"baabbababbbaababaabbabba",
"baababbabaaabbabbaaababbbabbbbbbbaababbbbabbbabbbababaab",
"bbaaabaaaaababbaaaabbbab",
"babaabbaabbbbbbbbabaabbb",
"ababaabaaaabbbaaabababaaaabaaabbbaaaaabb",
"baabbabbaabbaabbaaaabababbabaaab",
"aabaabbbaaababbbabbbbaab",
"bbbbbaaaaaabbabababbbbaaaabbbabb",
"baaabaabbaaabbbabaabaaababaabababbbababababbaaababaabaabbbbabbabaaabbabbaabbaaabaaabaaab",
"aabbbbbbaabaaabbbbabbaaabaaaaabaabbbaaaababaabaa",
"aaaabaabbababbabbbbabbbbaabbbababbbaaabaababaaaaabbabbab",
"babaababaaaabaabbaabaabbbaabbababbabbbbb",
"bbbaababbbbaabaaabbbabbbabbaaaba",
"baaaabbabbbbaaaaaaaaabbbbbabababbbbababaaababbbabbababababbbbbba",
"abbbabaaabaabbbaaabaabaabbbbbbab",
"babaaaaabaabaabaaaabaabb",
"aabababbabaabaaaaaaabbbabbaabbabaaaabbabbaaabbba",
"ababbbabbbbbbaaaaaabbaababbbaaaaaaaaabba",
"baabbabbbbabbaababbabbaaabaabbba",
"bbaaababbabbabbabbabbaabaaaaaababaabaaabaababaaa",
"baabbbbbbbbaabaaabbabaaa",
"abbabababaaabbabbaaaabab",
"ababbababaabaaabaabbbbbbbbbabaab",
"baabababbaaaabbababbaaaaabaabbaa",
"abbaaabbabbabbabaaaaabbbbabbbbaaababbbbbaababbabbaababbaabbbabba",
"abbbbababbabaabaabbaaaabbaabbabaaabbaababaaabaababaaaabbabababba",
"babbaaabbbabbabaaaabbbab",
"aabbbaaaabbbbabbaaabbbbb",
"baababbbbaaabbababbbabbbbbaaabaaaabbaaaaaaaabbab",
"babaabababababbababbbbbaabbabaaa",
"babaaabaaaabbabbaabaaababbaabaabbaababbbabaabbbabbbbabbaabbaabaa",
"baababbabababbabbbabbaabbaabbbaabbbababb",
"baabaabbababaabbaabbaaaaaaaaabba",
"aaaababbbabbaababbbbaaba",
"bbbabbbaaaaababbaabbbbaa",
"abaaaabaaaaaaaaaaaabbaaaabaabbab",
"ababbaabbabbaaaabbbbaaab",
"baaabbbbabbbaabababaabababaabbbb",
"baabaabaaabaaabbbbbaabaaaabaababaabbbbba",
"bbbbabaababbbaabaaaaaabbbaaababa",
"abbabababaabbabbababbabb",
"babababababaaaaaabbbbbaa",
"aabbbbbbbabaaaaabbbaaaaaabababbbabbbaabbababbaaa",
"babababaabaababaababaaab",
"baababbabaabbbbaaaabbbaabaaabbabababaababaaabaabababbbbbbbabababbaaabbaa",
"abbbaabaaabbbabaaaabbbbb",
"bbabbabaabbabbbaaabbabbbaababbababbabaaa",
"abbaababaaababbbabbbbbab",
"aaababbababaaabbabbababb",
"baaaaabababaaabbbaabbbaabaaabaaa",
"aabaaaabbbbbababaaababbb",
"abaaaabbbabbabbaabbbbbbbabbaabbb",
"bababaaababbbbaaaaaabababaaaababbaabbbabbaaabbabaabaaaaababaaaabaabaabbabbbaaabbaababaab",
"aabbabbbabbaaaaaaaababab",
"bbbaaaaaababbaabababbbba",
"ababababbbababbbaaabbaabbababbbabbaabbaa",
"aabbabaabaaabaabaaabaabaaaabaabbbbababbaaaababababbbbbabbbaabaaababbaabababaaaabbaaaaaba",
"abbbbabbbbaaaaaabbaabaaa",
"aaaababbbabaaabbbabaababaaabaaabaaaaabbb",
"ababbbaaabbabbaabbaaabbb",
"abaaaabbbaabbbaaaaabaaabbbabbbba",
"aaabaaaaaaabbabaabbabbaababbbbbaabaabbbb",
"aaabbabbbabbbaababaababbaaaaabbbaababbbb",
"aabaabaabaaaabbabaaabbaaabbabaaaaabbabbbbbabaaaabbbababbaabaabbb",
"abaabbaababbaaabbabaaabbbabaabbabbabbabaabbbbbabaababbaa",
"ababbbabbbbabbbbbaaaabbbabbabbbaaaaaaaab",
"abbbabbabaaabbababbbababaaabbaabaaaaabba",
"abaaaabababaaaaabbaabaabaababaaa",
"bbbbbbabbabbbbaaaaabbbabbbaaaabaaabaabab",
"bbbaaaaaabbbbbbbaabababa",
"baabaaaabbbabbbaabababbb",
"aabbbabaaaaaabaabbbabbaa",
"babaaabbaaaaabaaabbbbbbbbabaaabbaaaaabab",
"bababbbbbaabbabbbbaaabbb",
"bbaabbbaabbabbbbaabbbabb",
"abbabaabbabbaabaaababaaa",
"bababbaabaabaabbabbabbab",
"bbbaababbabbabaabaabbbbabaaaaabbbbbbaaab",
"bbbaababbabbbbaabababbba",
"babbaabbbabbabaaaabbabbbbabaaaabbbbababb",
"bbaabaababaabaaaababaaababaaabbaababbbbb",
"abbbabbbaababaaaaaabbabbabababaaaaababaaaaababbabbaababb",
"abbaaabbbaabbabbabaabbaaaababbbabbaabaabababbbabaaabbbab",
"abbbaaaaaabbbaaabbaaabbb",
"bbbbbabbabbabbaaabbabbbb",
"baabbabaaaaabababaaaaaab",
"aaaababbbbbabbbaaaababaabababbbb",
"abbbabaabbbababbbbabbbaaaaaaabaaaaaaabbbaaababab",
"baaabbbbaaabbaabbaaabbababbaababbbbaaaba",
"bbaababbbbbbbababaaababbabbabbbaaabbbabaabbbabbbbaaabaabaaabaaba",
"aaabaaaabbbbabbbbabbbabb",
"bbabbaababaababababbabbb",
"babbaaababbbbabbabbbaaabaabbabba",
"bbabbaabbabbabaababaaaaaaababbabbaaabbaababbbbbaababbbabaababbabbbabbbaabbbabbbbabaabbab",
"baabaaaaabaaaabbabbbbbbbaabbbaaabaaabbabbabbabbaaaaaaababaaababaaaaaabbb",
"bbaabbabbbaaabaabbaababa",
"aababbbabbbaabaaaaabbbab",
"baabbbbaabbabbaabbaaaabb",
"bbabbaabbaaaabaaaaaabbbb",
"baabaabaaabaabbaabababbb",
"abaabbaabbaabaabbbaabbabaaabbbaaaaaaabbb",
"bbbbbababbaaababbaabbaaa",
"bbaabbabbbabbaaabaabbbab",
"bbbaaaaaabbbbbbbaabbabaa",
"bbaaababbbabaabbaabbaaaaaaabbbbbbaaababaabbbbbbbbabaabaaaabbabab",
"aabbaabbbabbaaabaabbaaaabbababab",
"abbbabbaaaababbaabbaaaaa",
"aaabbabbbbaabaabbbabbaaaabbaaabbbabbbaba",
"abaabaaababbababaaababbbaabbbabb",
"abaaaabababbbbbbaaabaaaaabababbaaabbbbab",
"abbaabbbbbabbbbabbbaaababbabaaabbbabbbab",
"babbbbbbbabaabbabaababbaabaabaaaabbbabaababbbbab",
"bbbabbbbaabbaaaaabbaabaa",
"bbbbbaaababababbbaaababa",
"baabbbaabaabbababbbaababbbababbbabaabbbb",
"bbaababbbabaaabbabbbaaab",
"baabaaaaabbaaaaabbbaaaabbabbabbaaabbbaaaaabaabbbbbbbaaba",
"abbbababaaaaabaaababbabb",
"aaaaabaababbaaabaaaababbbaaabbbbababaaaa",
"ababbaababbabbbababbabbabbabbaababaaaaabbbbbaaaabbbaaaba",
"baaabaaabbbbabaaaababbaabbbaaabaababbabbaaabaaba",
"bababbaaababababaabbabbbaabaabaaabaaabbaabbbaaaaabbbabaa",
"abbaaabbabbaababbbaaaaaabbaaaabb",
"bbaabaabbbbaaaaabababababbabbbaaaaabbbba",
"bbaababbabbababaabbbaababbabbabbbbabaaab",
"abababaaabbbaaaabababbaaabbbaaababaaaaab",
"abbabaababbbbabbbbaabbbb",
"ababbaabbabbabababaaabbb",
"aababbbabababaababbbbbbaababbabbaababbbbbbbbaaaababbaabbbaaaaabb",
"abbbaaaaaabababbababbbba",
"babbabaaaaabbbaabaaabbaa",
"aabaaababaabbbaaaabaaababaaababbabbbaaaaaaaabbaa",
"bbaabbabbbabbabaaabbaaba",
"bababbaabbbaababbaaaabaaabbbbaab",
"bbbabbbabbbabbababbbaaab",
"abbbbbbbaabbabbbaaaabaabaabbaaabaaaabbbb",
"bbbbbabbbaababbbaabbaaba",
"ababababababababababbabb",
"baaaaaaabbabbaababaaabbb",
"bababbaaabbabababababbabaabaabbabbaababaababbbbb",
"bbabbaaabbbbaabaababababaabbbbabbabaabbbbaabbbaabbaaaababaabaabb",
"abbababaabaaaabbbabaaaab",
"bbabaabababbaabbbabbbbbbabbbbaabaabaabaa",
"bababbaaaabaaaaabbbbaabb",
"bbaabbabaabaabbbbabaabbaababaaababbaaaab",
"babaaabaaabaaaabababaabababbbaba",
"babbbbbaabababbaaaabbaabbabbabaabbaabbbb",
"abbababaabababaababaaababbbabbaa",
"aabaaaaaabbabbaabbabaababaababbaabaaabbb",
"abaabbaabbbbbaaaabbaabba",
"babaabbabaabbbbbbbabbbaababbbaabbbbababbaabbbaaabababbbbbaaababaabbbabbabbaaaabbaababaabaaaabbba",
"aaaabbbabbaaababaaabbaaaabababaababbbbababbaabbb",
"baabbabaabbaababaabbabab",
"ababaabbaabaaabaabbababb",
"aabbbababbaabbabaaaaabaa",
"ababaababbbabbbbbaaaabab",
"ababaababaaaaababbbabbbaabbbabaa",
"abaabbaaabbabababbbbabba",
"babbbbbabbaaaaaaaaaaabab",
"bbabbababbbabbbbababbbbb",
"abaababbabbaaabbbbbbababbbbbaaaa",
"abaaaabbbababbbbaababbbb",
"baabaababababbbbababbabb",
"baaaabaaaaabbabbabbabababaabbababbbbabaaabaaababbabbaaaa",
"aaaaaaaabbbabaaabbabbabaaabbbbaaabaaababababbabbabababab",
"bbbaaaabaaabaaaaaabaabbbbababaab",
"baabbbbabaaaaabaabbbaabb",
"abaaaabaabbaaaaaabaababbbaaabbba",
"ababbbaabbbaabaaaaababab",
"aaababbabbbbbabbabbbaaaabababaab",
"bbbbabbbbababbabaabbbbba",
"baaabbbbbbbbbaaabbaaabaaabaaabbaaababbab",
"bbabbaabababbbbbbbbaaabbabbbaaba",
"aaabbababaabaaabbaababbbbbaabbababbaaabbbbabbabbaabbbbab",
"abbaaaaabbabbaaaabbababb",
"baabaabbbaabbabababbaaabbaaaaababaaaabbabbbbbbaa",
"babbaabaaabababbbabbabaaabaaaaabbbaaabbb",
"babababbaabbaabbbbbbaaab",
"babaaababbbaabaaaaaabaabbbbaaaabababbaaa",
"aaabbbbbbbabababaabbabba",
"baaabbaaaaabbbbaaababbaaabbaaaaabbabbbbbabbbabbbbbbaaaaabbaaaababaaabbbbbaabbaababbbbbbababbaaaa",
"ababbababaabbabaababbbababaababbabbbaaaabbbbbbaaabbababb",
"babababababababaaaaabbab",
"aaabbaaaabbbbabbabaaabbb",
"babbbaaabababbaabaabaabaabbaababaaaabaaaababaaab",
"babaaaaaabbbbabbbbaabbba",
"bbabbaabaabbbaaaaabaaabaabbbababaabbaabaababaaaaababbbba",
"aabbbabaabbabbbababbaaaa",
"baaaabaababbabaabbbaabbb",
"aaabbabaaaabaaabaabbaaaabbaabbaa",
"abaabaaaabbabbaabbaababbabababbabbbbaabbbbaabbba",
"bbbaaaaabbabbabaabaaabaa",
"ababbbabbabbaababbaabbaa",
"aaabbaaaababbbabbaabbaaa",
"aaaaabaaabbabbaaabbbbaab",
"bbbaaaababaabaaabbbabbbabaabaaaabaabbbaaabbabaabaaaabbbb",
"babaaabababbbbbaaaaabbaa",
"baabaabbbabaabaabbaaaaab",
"baababbbbaaabbabaababbbb",
"bbaababbbbababbabbabbbbb",
"abbaababaabaabbaabbbbbbbbbaabbbbbbaababa",
"babaaaaaaaababbaabaaabab",
"babaaaaabbaabbaabaabbaabbbaabaaabbbbaabbbbbaabba",
"bbbaaabaaabbbabbabbaabbb",
"bbbbabababbaaaaaaabbbaaabbbbabaabbaaaaaabbbbaaaa",
"bbbaaaaaabaabaaabaaababa",
"aaabbababaaabbabbabaaaaaaaababababbbbaab",
"babbbbbabababbababaaabbb",
"aabababbaabbabbbbbbbbbba",
"abbabbaaabaababbbabbabbaaaaabaabaabbbbba",
"babbabbaabababbabababbbbaaababaaabbaaabbaabaabaa",
"aaaaaaaabbbabbbaabaaabba",
"baaaabaaabbbbbbaaabaabbbbbbbaaaa",
"abbbaaaabababaaabbbbbabbabaaabaaaaababbbabaababaabaaaaaa",
"abaababbabbbbbbaaabbabbbabbaaaab",
"abbabbbababbaaabbbabaaaabaababaaabbaabba",
"aaaabaabbbababbbbabbbbaabbbabbababaaaaab",
"abbaaabbabaababbbaabaababaaababa",
"abababababbaaabbbaaabbababaabaab",
"baaabbabaabaabbaaabababa",
"bbaaabaaaaaaabaababbaabb",
"ababbabaaabbabaaaabababa",
"babbbbaabbbbbaabbbaababa",
"babaaaababaabbababbabbbaabaaabababbabbaaaabbaabb",
"baaababbaaabaaabaabbabbbbaaaaaab",
"abaabbaabbabbaabaabababbabbabbbb",
"bbbaababaababbbabbababab",
"baababbabaaaabaaabababbababaaaab",
"babbaababbabaaaaababbaaa",
"aababbbaaabababbaabaabab",
"bbaabbabaabbbbbbbbababbbaaaabbbabbbbaaba",
"bbaaababbbaaabaabbbaaabaababbbbababbbabbababbbbaabaabbba",
"bbabaaaaaabbbababbaaabbb",
"baaaabaabaabbababaabaaababbbaabbbbabbaabbbbabbabaaababaaaabbaaaaaaaabbabaabbbabaabbabbaa",
"abaaaabbaabbabaaaabbbababbabaaaaaabbaaba",
"baaaaaabbbabbbbaabbbbbbbbbabaabbbabbabababaabababbbbaaabaaaabbbababbbbaa",
"aaaaaaaaaabbbabaaabbaaab",
"aababbbababaabbaaaabbbababbbaabb",
"abbbbabbaaabbbaaababaabbbabababa",
"aaaaabaabaaaabaaabbaabaa",
"bababbabbabaababbabbbabb",
"abbbbabbbaabbbabbbbaabaabbbaabbaaaaababaaaaaaaaababaaaba",
"aabaaababbbaabaabaabaaaabbbbaaababbbbaba",
"abbabaabbbaaababaaabaaba",
"bbaaababbbbbbaababbbabaa",
"bbabaaaababbbaaaabaaaaaa",
"aaabbaaabbabaababaaaabba",
"baabbabaaabbaaaaabbbbaba",
"baabaabababbaabbbbababaa",
"aaaabaabbbaaababaabbaabbabbbaaaaabaabaab",
"aaababbbaabaaaabbaaaabbbbabbbbba",
"aaabbbaababbaababbaaaaba",
"bbbabbbababbbaabbbaababa",
"abbbaaaabbabbbaaabbaabaa",
"aaaaaabbbbabbaaaabbabbbabaabbbabbbaaabaabaaaabaa",
"abababaaaaaaaaaaabbbaababaaaabbabbaabbabbabaabaaaabaabaababaabbabaabbbbb",
"ababbbaaabaabbaaabaababaabbbbbaa",
"abbabbbaababbababbbbbabaaabaabbabaabbabbbbaaaabaabaaabaa",
"ababbaabababbbabbbbbaaab",
"babbabaababaaabbbaabaabb",
"bbababbbaaabbaabbabbabaaaabaabaa",
"abaababbbaabbababaaababbbabaababbaaaaabaabbabbbb",
"ababababaaababaabbaaaabb",
"bbbaaaaaababbaababaabbba",
"babbbaababbbabbabbabaababaababbabbaababa",
"baabaabbbbaaaaaabbbaaabb",
"abbbaababbbbbabababbaabaaaaaabaaabbaaaaaabbbbaabaabbbbaaaabbbbabaababaab",
"ababaabbaabababbbbabbaabaaababaabaaaaababaaaabba",
"ababbbbbaabbaababababaababaaaaaaabbaaaaabbabbbaa",
"abbaaabbabaaaabbbbbabbbbbabbaabbbbbaaaaaabbbabbbbbbaabba",
"aaababbaaaaabaabbbaaababaaaabbbb",
"aabaaababbbbbbabaaabbabaabbaaaaabbbbbbbbababababbbaababbbabbabab",
"bbbaababbaaabbaabbbbbbaaabaaaaabaabbaababbaaaaab",
"aaaabbbaababbaabbabaabbababaaabbbaabbaab",
"bbbabababbababababbaabaa",
"bbbbabaabbaababbaaaabbbaabbbbbab",
"aaabbaaaaaaabbbaabbbbbbaabaaaabababbbaaabbaababbbaaaaaaaababbbbabababaaa",
"aaaaabbababbababbbababbbbaaababbabaabbaaaababbaabbaabbaa",
"bbabbabaaaaaabaabababbbbaaabbbba",
"ababbbaabbababbaaaaaaaab",
"babaaabbbaabbabaaaabaabb",
"babbababbbbbabaabababaab",
"bababbabbbaabaabbbbabaab",
"abbbaabaaabbbbbbaabbbbbbaabaaabbbbbbbaaaababbaaaaababaaabaaabaaa",
"abaabaaaabaababababaaabaaaabbbaabbabaaab",
"ababbbabaaaaaaaababbbbab",
"bbabbbbaabbbbabaaaaaabbbbababbaaabbbbbbbbbaabbbabbaaababababbbbbabbaabbabbabaaaabbbabbba",
"abaaaabbaaabbaabaaabaaaabbbabbbbababbbaabaabbbab",
"aabbbbbbbabbaababaabbababaabbbba",
"baaaabbbbababbabbbaabbba",
"abbbaaaaababbbababbabaaa",
"bbbabbbaaaababbaabaabbaaabaababaabbabababbaaabbaaaaaaabbabaabbabbbbaabbb"
];

const rawDataMessagesExample = [
"ababbb",
"bababa",
"abbbab",
"aaabbb",
"aaaabbb"
];

const rawDataRulesExample2 = [
"42: 9 14 | 10 1",
"9: 14 27 | 1 26",
"10: 23 14 | 28 1",
"1: a",
"11: 42 31",
"5: 1 14 | 15 1",
"19: 14 1 | 14 14",
"12: 24 14 | 19 1",
"16: 15 1 | 14 14",
"31: 14 17 | 1 13",
"6: 14 14 | 1 14",
"2: 1 24 | 14 4",
"0: 8 11",
"13: 14 3 | 1 12",
"15: 1 | 14",
"17: 14 2 | 1 7",
"23: 25 1 | 22 14",
"28: 16 1",
"4: 1 1",
"20: 14 14 | 1 15",
"3: 5 14 | 16 1",
"27: 1 6 | 14 18",
"14: b",
"21: 14 1 | 1 14",
"25: 1 1 | 1 14",
"22: 14 14",
"8: 42",
"26: 14 22 | 1 20",
"18: 15 15",
"7: 14 5 | 1 21",
"24: 14 1"
];

const rawDataMessagesExample2 = [
"abbbbbabbbaaaababbaabbbbabababbbabbbbbbabaaaa",
"bbabbbbaabaabba",
"babbbbaabbbbbabbbbbbaabaaabaaa",
"aaabbbbbbaaaabaababaabababbabaaabbababababaaa",
"bbbbbbbaaaabbbbaaabbabaaa",
"bbbababbbbaaaaaaaabbababaaababaabab",
"ababaaaaaabaaab",
"ababaaaaabbbaba",
"baabbaaaabbaaaababbaababb",
"abbbbabbbbaaaababbbbbbaaaababb",
"aaaaabbaabaaaaababaa",
"aaaabbaaaabbaaa",
"aaaabbaabbaaaaaaabbbabbbaaabbaabaaa",
"babaaabbbaaabaababbaabababaaab",
"aabbbbbaabbbaaaaaabbbbbababaaaaabbaaabba"
];


const gData = {}

function init(p_rawDataRules) {
	gData.data = generateArray(p_rawDataRules.length, null);
	var tokenWithIDs;
	var tokenChoices;
	var tokenSteps;
	var id;
	for (var i = 0 ; i < p_rawDataRules.length ; i++) {
		tokenWithIDs = p_rawDataRules[i].split(":");
		id = parseInt(tokenWithIDs, 10);
		var value = {choices : []};
		tokenChoices  = tokenWithIDs[1].split("|");
		for (var j = 0 ; j < tokenChoices.length ; j++) {
			value.choices.push([]);
			tokenSteps = tokenChoices[j].split(" ");
			for (var k = 0 ; k < tokenSteps.length ; k++) {
				if (tokenSteps[k] == "") {
					// Do nothing
				} else if (tokenSteps[k] == "a" || tokenSteps[k] == "b") {
					value.val = tokenSteps[k]; // Assuming all letters are alone in their rule
				} else {					
					value.choices[value.choices.length-1].push(parseInt(tokenSteps[k], 10));
				}
			}
		}
		gData.data[id] = value;
	}	
}

function testString(p_string) {
	var potentialFirstIndexes = testStringAux(p_string, 0, [0]);
	return potentialFirstIndexes[potentialFirstIndexes.length-1] == p_string.length;
}

// Returns the last characters when we apply the rules
function testStringAux(p_string, p_indexRule, p_potentialFirstIndexes) {
	const rule = gData.data[p_indexRule];

	// If the rule is one letter : return all "positions plus 1" that suit.
	if (rule.val) {
		var answer = [];
		var pos;
		for (var i = 0 ; i < p_potentialFirstIndexes.length ; i++) {
			pos = p_potentialFirstIndexes[i];
			if (pos < p_string.length && rule.val == p_string[pos]) {
				answer.push(pos+1);
			}
		}
		return answer;
	}
	var firstIndexes = [];
	var finalFirstIndexes = [];	
	for (var iCh = 0 ; iCh < rule.choices.length ; iCh++) { // For each rule ...
		firstIndexes = p_potentialFirstIndexes.slice(); // Follow the steps and establish the list of positions from the "first indexes".
		for (var iSt = 0 ; iSt < rule.choices[iCh].length ; iSt++) { 
			if (firstIndexes.length == 0) {
				break;
			}
			firstIndexes = testStringAux(p_string, rule.choices[iCh][iSt], firstIndexes);
		}
		
		// Now, insert into the final answer
		firstIndexes.forEach(index => {
			shiftIntoListUniqueNumbers(finalFirstIndexes, index);
		});
	}
	return finalFirstIndexes;
}

function conclusion_19_1() {
	init(rawDataRulesOfficial);
	const rawDataMessages = rawDataMessagesOfficial;
	var valid;
	var answer = 0;
	for (var i = 0 ; i < rawDataMessages.length ; i++) {
		valid = testString(rawDataMessages[i]);
		if (valid) { answer ++;}
		//console.log(rawDataMessages[i] + " : " + (valid ? "" : "in") + "valid");
	}
	return answer;  // Correct answer = 176
}

// ----
// Gasp... the 1st part was loopless. But now we have loops !

function init2(p_rawDataRules) {
	init(p_rawDataRules);
	gData[8] = {choices : [[42], [42, 8]]};
	gData[11] = {choices : [[42, 31], [42, 11, 31]]};
	// Actually, the only loops are with rules 8 and 11 that can call themselves. So not a big deal. 8 turns from 42 to (42)+, and 11 from (42 31) to (42^N 31^N). 
	// Since thanks to the looplessness of the 1st part, 42 cannot call 8 or 11 and 31 cannot call 11.
	gData.min42Length = calculateMinRule(42); // Minimal length of a string that obeys rule 42.
	gData.min31Length = calculateMinRule(31); // Same with rule 31
}

function testString2(p_string) {
	var potentialFirstIndexes = testString2Aux(p_string, 0, [0]);
	return potentialFirstIndexes[potentialFirstIndexes.length-1] == p_string.length;
}

// Returns the last characters when we apply the rules
function testString2Aux(p_string, p_indexRule, p_potentialFirstIndexes) {
	const rule = gData.data[p_indexRule];

	// If the rule is one letter : return all "positions plus 1" that suit.
	if (rule.val) {
		var answer = [];
		var pos;
		for (var i = 0 ; i < p_potentialFirstIndexes.length ; i++) {
			pos = p_potentialFirstIndexes[i];
			if (pos < p_string.length && rule.val == p_string[pos]) {
				answer.push(pos+1);
			}
		}
		return answer;
	}
	if (p_indexRule == 11) {
		// Special case : rule 11 = 42 repeated, then 31 repeated the same number of times, at least once.
		var firstIndexes = [];
		const good4231V = 2 + (p_string.length-p_potentialFirstIndexes[0]+1) / (gData.min42Length + gData.min31Length); // V because of the equal number of repeats of 42 and then 31. Could have been ^ if this character was suited for a variable name.
		// Added 2 for the margin
		var finalFirstIndexes = [];
		for (var iNumb = 0 ; iNumb < good4231V ; iNumb++) { // For each number of times 42 can be repeated... 
			firstIndexes = p_potentialFirstIndexes.slice();
			for (var iNumb2 = 0 ; iNumb2 <= iNumb ; iNumb2++) {				
				firstIndexes = testString2Aux(p_string, 42, firstIndexes);
			}
			for (var iNumb2 = 0 ; iNumb2 <= iNumb ; iNumb2++) {				
				firstIndexes = testString2Aux(p_string, 31, firstIndexes);
			}			
			// Now, insert into the final answer
			firstIndexes.forEach(index => {
				shiftIntoListUniqueNumbers(finalFirstIndexes, index);
			});
		}
		return finalFirstIndexes;
	} else if (p_indexRule == 8) {		
		// Special case : rule 8 = 42 repeated at least once. (a good estimation would be "the number of remaining chars to test" divided by "the minimal length of a string in rule 42")
		var firstIndexes = [];
		var finalFirstIndexes = [];
		const good42Repeat = 2 + (p_string.length-p_potentialFirstIndexes[0]+1) / (gData.min42Length);
		firstIndexes = p_potentialFirstIndexes.slice();
		for (var iNumb = 0 ; iNumb < good42Repeat ; iNumb++) { // For each number of times 42 can be repeated... 
			firstIndexes = testString2Aux(p_string, 42, firstIndexes);
			// Now, insert into the final answer
			firstIndexes.forEach(index => {
				shiftIntoListUniqueNumbers(finalFirstIndexes, index);
			});
		}
		return finalFirstIndexes;
	} else {		
		// Generic loopless case, like in 1st part
		var firstIndexes = [];
		var finalFirstIndexes = [];	
		for (var iCh = 0 ; iCh < rule.choices.length ; iCh++) { // For each rule ...
			firstIndexes = p_potentialFirstIndexes.slice(); // Follow the steps and establish the list of positions from the "first indexes".
			for (var iSt = 0 ; iSt < rule.choices[iCh].length ; iSt++) { 
				if (firstIndexes.length == 0) {
					break;
				}
				firstIndexes = testString2Aux(p_string, rule.choices[iCh][iSt], firstIndexes);
			}
			
			// Now, insert into the final answer
			firstIndexes.forEach(index => {
				shiftIntoListUniqueNumbers(finalFirstIndexes, index);
			});
		}
		return finalFirstIndexes;
	}
	
}

function calculateMinRule(p_indexRule) {
	var answer = 9999;
	var rule = gData.data[p_indexRule];
	if (rule.val) {
		return 1;
	}
	if (rule.minRule) {
		return rule.minRule;
	}
	var minThis;
	for (var iCh = 0 ; iCh < rule.choices.length ; iCh++) { // For each rule ...
		minThis = 0;
		for (var iSt = 0 ; iSt < rule.choices[iCh].length ; iSt++) { 
			minThis += calculateMinRule(rule.choices[iCh][iSt]);
		}
		answer = Math.min(minThis, answer);
	}
	rule.minRule = answer;
	return answer;
}

function conclusion_19_2() {
	init2(rawDataRulesOfficial);
	const rawDataMessages = rawDataMessagesOfficial;
	var valid;
	var answer = 0;
	for (var i = 0 ; i < rawDataMessages.length ; i++) {
		valid = testString2(rawDataMessages[i]);
		if (valid) { answer ++;}
		//console.log(rawDataMessages[i] + " : " + (valid ? "" : "in") + "valid");
	}
	return answer;  // Correct answer = 352 (2x the 1st)
}