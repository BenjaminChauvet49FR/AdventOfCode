const rawDataOfficial = [
"#.###########################################################################################################################################",
"#.......#...#...###...#.....#...#.....#...#####...#...............#...#...#...#.......#.......#...###...#####.......###.........###.......###",
"#######.#.#.#.#.###.#.#.###.#.#.#.###.#.#.#####.#.#.#############.#.#.#.#.#.#.#.#####.#.#####.#.#.###.#.#####.#####.###.#######.###.#####.###",
"#.......#.#.#.#.#...#.#...#.#.#.#...#.#.#.....#.#.#...........#...#.#.#.#.#.#.#.#.....#.....#...#.....#...#...#...#.....#.......#...#...#...#",
"#.#######.#.#.#.#.###.###.#.#.#.###.#.#.#####.#.#.###########.#.###.#.#.#.#.#.#.#.#########.#############.#.###.#.#######.#######.###.#.###.#",
"#...#...#.#.#.#.#...#.....#...#...#.#...#.....#.#.#...###...#.#...#.#...#...#.#.#...#.>.>.#...#.........#.#...#.#.........###.....#...#.....#",
"###.#.#.#.#.#.#.###.#############.#.#####.#####.#.#.#.###.#.#.###.#.#########.#.###.#.#v#.###.#.#######.#.###.#.#############.#####.#########",
"###...#.#.#.#.#.###.......#...#...#.....#.....#.#.#.#.#...#...#...#...###.....#...#.#.#.#...#.#.#...###...#...#.......###...#...#...#.......#",
"#######.#.#.#.#.#########.#.#.#.#######.#####.#.#.#.#.#.#######.#####.###.#######.#.#.#.###.#.#.#.#.#######.#########.###.#.###.#.###.#####.#",
"#.......#.#.#.#.#...###...#.#...#...#...#.....#.#.#.#.#.......#.....#...#.....#...#...#...#.#.#.#.#...#.>.>.#...#.....#...#...#.#...#.#.....#",
"#.#######.#.#.#.#.#.###.###.#####.#.#.###.#####.#.#.#.#######.#####.###.#####.#.#########.#.#.#.#.###.#.#v###.#.#.#####.#####.#.###.#.#.#####",
"#.#.....#.#.#.#.#.#...#...#.>.>.#.#.#.#...#...#.#.#.#...###...#.....#...#.....#.#...###...#.#.#.#.#...#.#.#...#...#...#.#.....#.#...#.#...###",
"#.#.###.#.#.#.#.#.###.###.###v#.#.#.#.#.###.#.#.#.#.###.###.###.#####.###.#####.#.#.###.###.#.#.#.#.###.#.#.#######.#.#.#.#####.#.###.###.###",
"#.#.#...#.#.#.#.#...#.#...#...#.#.#.#.#.###.#.#.#.#.#...#...#...#...#.###...#...#.#.#...###...#...#.....#.#.#.....#.#.#.#.###...#...#...#.###",
"#.#.#.###.#.#.#v###.#.#.###.###.#.#.#.#.###.#.#.#.#.#.###.###.###.#.#.#####.#.###.#.#.###################.#.#.###.#.#.#.#.###.#####.###.#.###",
"#.#.#.#...#...#.>.#.#.#.###...#.#.#.#.#.#...#...#...#.>.>.###.#...#.#...#...#.#...#...#...#.......#.......#.#.#...#.#...#.###.#.....#...#...#",
"#.#.#.#.#######v#.#.#.#.#####.#.#.#.#.#.#.#############v#####.#.###.###.#.###.#.#######.#.#.#####.#.#######.#.#.###.#####.###.#.#####.#####.#",
"#.#.#...#.......#...#.#.#####.#.#.#.#.#.#.......###...#.....#.#...#.#...#...#.#.........#.#.#...#.#.......#.#.#...#.....#.###.#.#...#...#...#",
"#.#.#####.###########.#.#####.#.#.#.#.#.#######.###.#.#####.#.###.#.#.#####.#.###########.#.#.#.#.#######.#.#.###.#####.#.###.#.#.#.###.#.###",
"#...#...#...........#.#.#.....#...#...#.#.....#.#...#.......#...#.#.#...###...#.........#.#...#.#.#...#...#.#...#.#...#.#.#...#...#...#.#.###",
"#####.#.###########.#.#.#.#############.#.###.#.#.#############.#.#.###.#######.#######.#.#####.#.#.#.#.###.###.#.#.#.#.#.#.#########.#.#.###",
"#.....#.............#...#.............#.#...#...#...#.......###...#.....#.....#.......#.#.#.....#...#...###.#...#.#.#...#...#...#...#...#...#",
"#.###################################.#.###.#######.#.#####.#############.###.#######.#.#.#.###############.#.###.#.#########.#.#.#.#######.#",
"#.#...............#...#...............#.....###...#...#.....#...........#...#.....#...#...#...............#...###...###...#...#.#.#.......#.#",
"#.#.#############.#.#.#.#######################.#.#####.#####.#########.###.#####.#.#####################.#############.#.#.###.#.#######.#.#",
"#.#.#...#...#.....#.#.#.......###...#.....#...#.#.#...#.....#...#.......#...#...#...#...#...#.............#...#.....#...#.#...#.#.......#.#.#",
"#.#.#.#.#.#.#.#####.#.#######.###.#.#.###.#.#.#.#.#.#.#####.###.#.#######.###.#.#####.#.#.#.#.#############.#.#.###.#.###.###.#.#######.#.#.#",
"#.#.#.#...#...#...#.#.#...###...#.#.#.#...#.#.#.#.#.#.###...###.#...#...#.....#.......#...#.#.............#.#.#.#...#.#...#...#.........#.#.#",
"#.#.#.#########.#.#.#.#.#.#####.#.#.#.#.###.#.#.#.#.#.###v#####.###.#.#.###################.#############.#.#.#.#.###.#.###v#############.#.#",
"#.#.#.#...#...#.#.#.#.#.#.#...#...#...#...#.#.#.#...#.#.>.>.###.#...#.#.#...###...#.........#...#.........#.#...#...#.#.#.>.#...#...#####...#",
"#.#.#.#.#v#.#.#.#.#.#.#.#.#.#.###########v#.#.#.#####.#.#v#.###.#.###.#.#.#.###.#.#.#########.#.#.#########.#######.#.#.#.#v#.#.#.#.#########",
"#.#.#.#.#.>.#.#.#.#.#.#.#.#.#.#...#.....>.>.#.#.#...#...#.#.#...#...#.#.#.#...#.#.#...#.....#.#.#.........#.......#.#.#.#.#.#.#.#.#.........#",
"#.#.#.#.#v###.#.#.#.#.#.#.#.#.#.#.#.#####v###.#.#.#.#####.#.#.#####.#.#.#.###.#.#.###.#.###.#.#.#########.#######.#.#.#.#.#.#.#.#.#########.#",
"#...#...#...#.#.#.#.#.#.#.#.#.#.#.#.#.....#...#.#.#...#...#...###...#.#.#.#...#.#.#...#.#...#.#.#...###...#...#...#.#.#.#.#.#.#.#.#...#.....#",
"###########.#.#.#.#.#.#.#.#.#.#.#.#.#.#####.###.#.###.#.#########.###.#.#.#.###.#.#v###.#.###.#.#.#.###v###.#.#.###.#.#.#.#.#.#.#.#.#.#.#####",
"#...........#...#...#.#.#.#.#.#.#...#.....#.....#...#.#.....#.....#...#.#.#...#.#.>.>...#.#...#.#.#...>.>.#.#.#...#...#.#.#.#.#.#.#.#...#####",
"#.###################.#.#.#.#.#.#########.#########.#.#####.#.#####.###.#.###.#.###v#####.#.###.#.#####v#.#.#.###.#####.#.#.#.#.#.#.#########",
"#.#.............#...#...#.#.#...#...#...#.......#...#.......#...#...#...#...#...###...###.#...#.#.#.....#...#...#.....#...#...#.#.#...#...###",
"#.#.###########.#.#.#####.#.#####.#.#.#.#######.#.#############.#.###.#####.#########.###.###.#.#.#.###########.#####.#########.#.###.#.#.###",
"#.#.#...........#.#.#...#.#.#.....#...#...#...#.#...........###.#...#...#...#.......#...#.#...#.#.#...........#.#.....###.......#...#...#...#",
"#.#.#.###########.#.#.#.#.#.#.###########.#.#.#.###########.###.###.###.#.###.#####.###.#.#.###.#.###########.#.#.#######.#########.#######.#",
"#...#.....#...#...#...#.#...#.....#...###.#.#...#...###...#.#...#...#...#.###.#...#.....#...###.#.#...........#.#.#.....#.......#...#.......#",
"#########.#.#.#.#######.#########.#.#.###.#.#####.#.###.#.#.#.###.###.###.###.#.#.#############.#.#.###########.#.#.###.#######.#.###.#######",
"#...#...#...#...#.....#.#...#...#...#...#.#...#...#.....#...#...#...#...#.#...#.#.#...#.......#.#.#.#.......#...#...#...#.......#.#...#######",
"#.#.#.#.#########.###.#.#.#.#.#.#######.#.###.#.###############.###.###.#.#.###.#.#.#.#.#####.#.#.#.#.#####.#.#######.###.#######.#.#########",
"#.#...#...........###...#.#.#.#.###.....#...#.#.............###.....###...#.....#...#.#.#.....#...#...#.....#.....#...###...#.....#.........#",
"#.#######################.#.#.#.###.#######.#.#############.#########################.#.#.#############.#########.#.#######.#.#############.#",
"#.................#.......#...#...#...#...#...#.............#...#.............#...#...#.#.###...#.......###...###...#...###...###...#.......#",
"#################.#.#############.###.#.#.#####.#############.#.#.###########.#.#.#.###.#.###.#.#.#########.#.#######.#.#########.#.#.#######",
"#.....#...........#.............#.....#.#...###...............#.#.........#...#.#.#.....#.....#.#.#.........#.....###.#.#...#...#.#.#.......#",
"#.###.#.#######################.#######.###.###################.#########.#.###.#.#############.#.#.#############.###.#.#.#.#.#.#.#.#######.#",
"#...#.#.......#...###...#...###.....###.#...#...#...............###...#...#...#.#.#.............#...###.....#...#...#.#...#.#.#...#.........#",
"###.#.#######v#.#.###.#.#.#.#######.###.#.###.#.#.#################.#.#.#####.#.#.#.###################.###.#.#.###.#.#####.#.###############",
"#...#...#...#.>.#...#.#.#.#.###...#.#...#.....#.#.#.....#...#...#...#.#.....#.#.#.#.............#.......###...#.#...#.....#.#...............#",
"#.#####.#.#.#v#####.#.#.#.#.###.#.#v#.#########.#.#.###.#.#.#.#.#.###.#####.#.#.#.#############.#.#############.#.#######.#.###############.#",
"#.#...#...#...###...#.#.#.#.#...#.>.>.#.....#...#...#...#.#.#.#.#.#...#...#.#.#.#.###...........#.............#...#...#...#...#.........#...#",
"#.#.#.###########.###.#.#.#.#.#####v###.###.#.#######.###.#.#.#.#.#.###.#.#.#.#.#.###v#######################.#####.#.#.#####.#.#######.#.###",
"#.#.#...#...#...#...#.#.#.#.#.#.....###...#...###...#...#.#.#.#...#...#.#.#.#...#...>.>.###...###.........#...###...#.#.....#.#.......#...###",
"#.#.###.#.#.#.#.###.#.#.#.#.#.#.#########.#######.#.###.#.#.#.#######.#.#.#.#########v#.###.#.###.#######.#.#####.###.#####.#.#######v#######",
"#.#.###...#.#.#...#...#...#...#.......###...###...#.....#.#...#...#...#.#...###...#...#...#.#...#.......#...#...#...#.#...#.#.#...#.>.#...###",
"#.#.#######.#.###.###################.#####.###.#########.#####.#.#.###.#######.#.#.#####.#.###.#######.#####.#.###.#.#.#.#.#.#.#.#.#v#.#.###",
"#...#.......#.###...#...#...#...#...#.....#...#.......#...#...#.#.#.....#.......#...#...#.#.#...#.....#...#...#.#...#...#...#...#...#...#...#",
"#####.#######.#####.#.#.#.#.#.#.#.#.#####.###.#######v#.###.#.#.#.#######.###########.#.#.#.#.###.###.###.#.###.#.#########################.#",
"#...#.........#...#...#.#.#...#...#.....#.###...#...>.>.###.#...#.......#...........#.#.#.#.#...#.#...#...#...#.#.....#.....................#",
"#.#.###########.#.#####.#.#############.#.#####.#.###v#####.###########.###########.#.#.#.#.###.#.#.###v#####.#.#####.#.#####################",
"#.#.#...###.....#.......#.............#...#.....#...#.#...#.#...........#.........#...#.#...#...#.#.#.>.>...#.#...#...#.....................#",
"#.#.#.#.###.#########################.#####.#######.#.#.#.#.#.###########.#######.#####.#####.###.#.#.#v###.#.###.#.#######################.#",
"#.#...#...#...#.......#...#...........#...#.......#.#.#.#.#.#.....#...###.......#.#...#...###.....#...#.#...#...#.#...#...#...###.....#.....#",
"#.#######.###.#.#####.#.#.#.###########.#.#######.#.#.#.#.#.#####.#.#.#########.#.#.#.###.#############.#.#####.#.###.#.#.#.#.###.###.#.#####",
"#...#...#...#...#.....#.#.#.........###.#...#...#.#.#.#.#...#.....#.#...#.......#...#.#...#.............#.......#.#...#.#...#...#...#.#.....#",
"###.#.#.###.#####.#####.#.#########.###.###.#.#.#.#.#.#.#####.#####.###.#.###########.#.###.#####################.#.###.#######.###.#.#####.#",
"###...#.#...#...#.....#.#.........#.#...#...#.#.#...#...#...#.......#...#...#...#...#.#...#.....#...#...###...###...###.......#.....#.#...#.#",
"#######.#.###.#.#####.#.#########.#.#.###.###.#.#########.#.#########.#####.#.#.#.#.#.###.#####.#.#.#.#.###.#.###############.#######.#.#.#.#",
"#.......#.....#.......#.........#...#...#.....#...#...#...#...........#####...#...#.#.#...###...#.#...#.....#.....###.........#...###.#.#...#",
"#.#############################.#######.#########.#.#.#.###########################.#.#.#####.###.###############.###.#########.#.###.#.#####",
"#.#.....#.................#.....#...#...#...#.....#.#.#.................#...#...#...#...#...#.#...#.............#...#.#.........#...#.#.....#",
"#.#.###.#.###############.#.#####.#.#.###.#.#.#####.#.#################.#.#.#.#.#.#######.#.#.#.###.###########.###.#.#.###########.#.#####.#",
"#.#.#...#.#...........#...#...###.#.#.....#.#.#...#.#.#...#...#.........#.#.#.#.#...#...#.#.#...###.......#...#...#.#.#.#...........#...#...#",
"#.#.#.###.#.#########.#.#####.###.#.#######.#.#.#.#.#.#.#.#.#.#v#########.#.#.#.###.#.#.#.#.#############.#.#.###.#.#.#.#.#############.#.###",
"#...#...#.#.....#...#...#...#.#...#.#...#...#.#.#.#.#.#.#...#.>.>.....#...#.#.#.#...#.#...#.#...#...#...#...#...#...#...#.............#.#...#",
"#######.#.#####.#.#v#####.#.#v#.###.#.#.#.###.#.#.#.#.#.#######v#####.#.###.#.#.#.###.#####.#.#.#.#.#.#.#######.#####################.#.###.#",
"#.....#...#...#...#.>...#.#.>.>.###...#.#.#...#.#.#.#.#...#.....#...#.#.#...#.#.#...#.#.....#.#.#.#.#.#.#.....#...#...#...###.....#...#.....#",
"#.###.#####.#.#####v###.#.###v#########.#.#.###.#.#.#.###.#.#####.#.#.#.#.###.#.###v#.#.#####.#.#.#.#.#.#v###.###.#.#.#.#.###.###.#.#########",
"#...#.#...#.#.......###...#...###...#...#.#.#...#.#.#...#.#.....#.#.#.#.#...#.#.#.>.>.#...#...#...#.#.#.>.>.#.....#.#.#.#.#...#...#.........#",
"###.#.#.#.#.###############.#####.#.#.###.#.#.###.#.###.#.#####.#.#.#.#.###.#.#.#.#v#####.#.#######.#.###v#.#######.#.#.#.#.###.###########.#",
"#...#.#.#.#...............#.....#.#.#.....#.#.#...#...#.#.#...#...#.#.#.###.#.#...#.....#.#.###.....#.###.#.......#.#.#.#.#...#.........#...#",
"#.###.#.#.###############.#####.#.#.#######.#.#.#####.#.#.#.#.#####.#.#.###.#.#########.#.#.###.#####.###.#######.#.#.#.#.###v#########.#.###",
"#...#...#.....#...#.......#.....#.#.#...###...#...#...#.#.#.#.......#.#...#...###.......#.#...#.#...#.#...#.....#...#...#...>.#.......#.#...#",
"###.#########.#.#.#.#######.#####.#.#.#.#########.#.###.#.#.#########.###.#######.#######.###.#.#.#.#.#.###.###.#############v#.#####.#.###.#",
"###.........#.#.#...#.....#.......#...#.......###...###...#.#...#...#.#...###...#.......#.....#.#.#.#.#...#.#...###...#.......#.#.....#.....#",
"###########.#.#.#####.###.###################.#############.#.#.#.#.#.#.#####.#.#######.#######.#.#.#.###.#.#.#####.#.#.#######.#.###########",
"#...........#...#...#.#...#.............#.....#.............#.#...#.#...#.....#.........#...###...#.#.###...#.......#.#.#.......#...#...#...#",
"#.###############.#.#.#.###.###########.#.#####.#############.#####.#####.###############.#.#######.#.###############.#.#.#########.#.#.#.#.#",
"#...........#.....#...#...#...........#...#...#.....#.........#...#.....#.#...#...........#.....###...#...#.....#.....#...###.....#...#...#.#",
"###########.#.###########.###########.#####.#.#####.#.#########.#.#####.#.#.#.#.###############.#######.#.#.###.#.###########.###.#########.#",
"#...........#.#...........###...#...#.....#.#.#...#...#.........#.#...#.#.#.#...#.........#.....#.......#.#...#...#...#...#...###...#...#...#",
"#.###########.#.#############.#.#.#.#####.#.#.#.#.#####.#########.#.#.#.#.#.#####.#######.#.#####.#######.###.#####.#.#.#.#.#######.#.#.#.###",
"#.............#.....###.......#...#.......#.#.#.#.#...#.........#...#...#...#...#.......#.#.#...#.....#...###.#...#.#.#.#.#.....###...#.#.###",
"###################.###.###################.#.#.#.#.#.#########.#############.#.#######.#.#.#.#.#####.#.#####.#.#.#.#.#.#.#####.#######.#.###",
"###...#...#...#...#...#.......#.....#...###.#.#.#.#.#.....#...#.........###...#...#.....#...#.#...###.#.#...#.#.#.#.#.#.#.#...#...#.....#...#",
"###.#.#.#.#.#.#.#.###.#######.#.###.#.#.###.#.#.#.#.#####.#.#.#########.###.#####.#.#########.###.###.#.#.#.#v#.#.#.#.#.#.#.#.###v#.#######.#",
"#...#...#...#...#.....#...###.#...#...#.....#.#.#.#.....#...#.........#.#...#...#...###.....#...#.#...#.#.#.>.>.#.#.#.#.#.#.#.#.>.#.......#.#",
"#.#####################.#.###v###.###########.#.#.#####.#############.#.#.###.#.#######.###.###.#.#.###.#.###v###.#.#.#.#.#.#.#.#v#######.#.#",
"#.#.....#...#.........#.#.#.>.>...#.......#...#.#.#...#...#.....#...#...#.....#.......#.#...#...#...###...###...#.#.#...#...#...#.#...###...#",
"#.#.###.#.#.#.#######.#.#.#.#v#####.#####.#.###.#.#.#.###.#.###.#.#.#################.#.#.###.#################.#.#.#############.#.#.#######",
"#.#.###.#.#.#.#.......#.#.#.#...#...#####...###.#.#.#.###...#...#.#.#.....#...........#.#.###.......#...........#.#.....###.....#...#.#.....#",
"#.#.###.#.#.#.#.#######.#.#.###.#.#############.#.#.#.#######.###.#.#.###.#.###########.#.#########.#.###########.#####.###.###.#####.#.###.#",
"#.#.#...#.#.#.#.#.....#.#...###.#.....#...#...#.#...#...#...#.....#...#...#.............#.###...#...#...........#.#...#.#...#...#...#...#...#",
"#.#.#.###.#.#.#.#.###.#.#######.#####.#.#.#.#.#.#######.#.#.###########.#################.###.#.#.#############.#.#.#.#.#.###.###.#.#####.###",
"#...#.....#...#...#...#.....#...#...#.#.#.#.#.#.#.......#.#.###.......#.#...#.....#.......#...#.#.#.........#...#.#.#.#.#...#.#...#...#...###",
"###################v#######.#.###.#.#.#.#.#.#.#.#.#######.#.###v#####.#.#.#.#.###.#.#######.###.#.#.#######.#.###.#.#.#.###.#.#.#####.#.#####",
"#...#...#...#.....#.>.#.....#.#...#.#...#...#.#.#.#.....#.#.#.>.>...#...#.#.#.#...#.###...#.###...#.#.....#...###.#.#.#.#...#.#...#...#.....#",
"#.#.#.#.#.#.#.###.#v#.#.#####.#.###.#########.#.#.#.###.#.#.#.#v###.#####.#.#.#.###v###.#.#.#######.#.###.#######.#.#.#.#.###.###.#.#######.#",
"#.#.#.#.#.#.#...#.#.#...#...#.#.#...#.......#.#.#.#.#...#.#...#...#...#...#.#.#...>.>.#.#.#.......#...###.......#...#...#...#.....#.......#.#",
"#.#.#.#.#.#.###.#.#.#####.#.#.#.#.###.#####.#.#.#.#.#.###.#######.###.#.###.#.#####v#.#.#.#######.#############.###########.#############.#.#",
"#.#...#...#.....#.#.....#.#...#.#...#.#.....#...#.#.#.....#.......###...###.#.###...#...#.#.......###...........###.......#...#.........#.#.#",
"#.###############.#####.#.#####.###.#.#.#########.#.#######.###############.#.###.#######.#.#########.#############.#####.###.#.#######.#.#.#",
"#.......#.......#.......#.....#.###...#.........#...#.....#...............#.#.#...#...###...###.....#.....#...#...#.....#.....#.#.......#...#",
"#######.#.#####.#############.#.###############.#####.###.###############.#.#.#.###.#.#########.###.#####.#.#.#.#.#####.#######.#.###########",
"#...###...#...#.#...........#...#...#...........#.....#...#.......#.......#...#.....#.....#...#...#.#.....#.#.#.#...###.....#...#.#...#.....#",
"#.#.#######.#.#.#.#########.#####.#.#.###########.#####.###.#####.#.#####################.#.#.###.#.#.#####.#.#.###.#######.#.###.#.#.#.###.#",
"#.#.#...#...#.#...#.....#...#.....#...#.........#.....#...#.....#...#.....###...#...#...#...#.#...#...#.....#.#...#.....#...#.#...#.#.#.#...#",
"#.#.#.#.#.###.#####.###.#.###.#########.#######.#####.###.#####.#####.###.###.#.#.#.#.#.#####.#.#######.#####.###.#####.#.###.#.###.#.#.#.###",
"#.#.#.#.#...#.#.....###...###.........#.#.......#...#...#.#...#.#...#.#...#...#...#...#...#...#.........#...#.#...#.....#.....#.....#...#...#",
"#.#.#.#.###.#.#.#####################.#.#.#######.#.###.#.#.#.#.#.#.#.#.###.#############.#.#############.#.#.#.###.#######################.#",
"#.#...#.....#...#.......#...#...#...#...#.......#.#.....#.#.#.#.#.#.#.#...#.........#...#...#.....#...###.#...#...#.#...###.................#",
"#.###############.#####.#.#.#.#.#.#.###########.#.#######.#.#.#v#.#.#.###.#########.#.#.#####.###.#.#.###v#######.#.#.#.###v#################",
"#.#...#...........#.....#.#.#.#.#.#.###.........#.......#.#.#.>.>.#.#.#...###...#...#.#.#...#...#.#.#.#.>.>.#...#.#.#.#.#.>.#...#...#...#...#",
"#.#.#.#.###########.#####.#.#.#.#.#.###.###############.#.#.#######.#.#.#####.#.#v###.#.#.#.###.#.#.#.#.###.#.#.#.#.#.#.#.#v#.#.#.#.#.#.#.#.#",
"#.#.#.#.#...........###...#.#.#.#.#...#...........#.....#.#.....#...#.#...#...#.>.>.#.#.#.#...#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#...#...#.#.#.#",
"#.#.#.#.#.#############.###.#.#.#.###.###########.#.#####.#####.#.###.###.#.#######.#.#.#.###.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#########.#.#.#",
"#.#.#.#.#.#...#.........#...#.#...#...#...........#.....#.#...#.#.....#...#...###...#.#.#.###.#.#...#.#.#...#.#.#.#.#.#.#.#.#.#.........#.#.#",
"#.#.#.#.#.#.#.#.#########.###.#####.###.###############.#.#.#.#.#######.#####.###.###.#.#.###.#.#####.#.###.#.#.#.#.#.#.#.#.#.#.#########.#.#",
"#.#.#.#.#.#.#...#.......#...#.....#...#.....#...#####...#.#.#.#.#.......#...#...#...#.#.#...#.#...#...#.#...#.#.#.#...#.#.#.#.#.....#...#.#.#",
"#.#.#.#.#.#.#####.#####.###.#####.###.#####.#.#.#####.###.#.#.#.#.#######.#.###.###.#.#.###.#.###.#.###.#.###.#.#.#####.#.#.#.#####.#.#.#.#.#",
"#...#...#...#.....#...#.....#...#.#...###...#.#...#...###.#.#.#.#.#.....#.#.#...###.#.#...#.#...#.#.#...#.#...#...#...#.#.#.#.#.....#.#...#.#",
"#############.#####.#.#######.#.#.#.#####v###.###.#.#####.#.#.#.#.#.###.#.#.#.#####.#.###.#.###.#.#.#.###.#.#######.#.#.#.#.#.#.#####.#####.#",
"#.............#...#.#.#.....#.#.#.#...#.>.>.#...#.#.....#.#.#.#.#.#.#...#.#.#.....#.#.#...#...#.#.#.#...#.#...#.....#...#.#.#.#...#...#.....#",
"#.#############.#.#.#.#.###.#.#.#.###.#.###.###.#.#####.#.#.#.#.#.#.#.###.#.#####.#.#.#.#####.#.#.#.###.#.###.#.#########.#.#.###.#.###.#####",
"#...............#...#...###...#...###...###.....#.......#...#...#...#.....#.......#...#.......#...#.....#.....#...........#...###...###.....#",
"###########################################################################################################################################.#"
];

const rawDataExample = [
"#.#####################",
"#.......#########...###",
"#######.#########.#.###",
"###.....#.>.>.###.#.###",
"###v#####.#v#.###.#.###",
"###.>...#.#.#.....#...#",
"###v###.#.#.#########.#",
"###...#.#.#.......#...#",
"#####.#.#.#######.#.###",
"#.....#.#.#.......#...#",
"#.#####.#.#.#########v#",
"#.#...#...#...###...>.#",
"#.#.#v#######v###.###v#",
"#...#.>.#...>.>.#.###.#",
"#####v#.#.###v#.#.###.#",
"#.....#...#...#.#.#...#",
"#.#########.###.#.#.###",
"#...###...#...#...#.###",
"###.###.#.###v#####v###",
"#...#...#.#.>.>.#.>.###",
"#.###.###.#.###.#.#v###",
"#.....###...###...#...#",
"#####################.#"
];

var rawData;
var gData;
var gCrossroadsArray;

function getChar(p_x, p_y) {
	return rawData[p_y].charAt(p_x);
}

function init() {
	gData = [];
	gCrossroadsArray = generateDoubleEntryArray(rawData[0].length, rawData.length, -1);
	endRoad(-1, 1, 0, 0); // Start with ending a fictionos road to add a startpoint crossroads-lite
	var i = 0;
	while (i != gData.length) {		
		getNextCRs(i);
		i++;
	}
}
 
function getNextCRs(p_index) {
	var cr = gData[p_index];
	var x = cr.x;
	var y = cr.y;
	if (y == rawData.length-1) {
		return;
	}
	if (y > 0 && getChar(x, y-1) != '#' && getChar(x, y-1) != 'v') {
		traceRoad(p_index, x, y-1, DIRECTION.DOWN);
	}
	if (getChar(x, y+1) != '#' && getChar(x, y+1) != '^') {
		traceRoad(p_index, x, y+1, DIRECTION.UP);
	}
	if (getChar(x+1, y) != '#' && getChar(x+1, y) != '<') {
		traceRoad(p_index, x+1, y, DIRECTION.LEFT);
	}
	if (getChar(x-1, y) != '#' && getChar(x-1, y) != '>') {
		traceRoad(p_index, x-1, y, DIRECTION.RIGHT);
	}
}

function traceRoad(p_index, p_x, p_y, p_dirFrom) {
	var nbDirs = 0;
	var distance = 1; // We already walked one step since last CR
	var dirFrom = p_dirFrom;
	var dirTo;
	var x = p_x;
	var y = p_y;
	var xx, yy;
	do {		
		newDirections = [];
		KnownDirections.forEach(dir => {
			xx = x + DeltaX[dir];
			yy = y + DeltaY[dir];
			if (dir != dirFrom && getChar(xx, yy) != '#') {
				newDirections.push(dir);
			}
		});	
		if (newDirections.length == 1) {
			dirTo = newDirections[0];
			x += DeltaX[dirTo];
			y += DeltaY[dirTo];
			dirFrom = OppositeDirection[dirTo];
			distance++;
		} 
	} while (newDirections.length == 1 && y != rawData.length-1); 
	endRoad(p_index, x, y, distance);
}

function endRoad(p_indexFrom, p_xTo, p_yTo, p_dist)  {
	var indCR = gCrossroadsArray[p_yTo][p_xTo];
	if (indCR == -1) {
		indCR = gData.length;
		gCrossroadsArray[p_yTo][p_xTo] = indCR;
		gData.push({
			x : p_xTo,
			y : p_yTo,
			nextCrossRoads : []
		});
	}
	if (p_indexFrom != -1) { // -1 : for start.		
		gData[p_indexFrom].nextCrossRoads.push({destination : indCR, distance : p_dist});
	}
}

function conclusion_23_1() {
	rawData = rawDataOfficial;
	init();
	return longestFrom(0, 0);
}

function longestFrom(p_index, p_distance) {
	if (p_index == gData.length-1) {
		return p_distance;
	} 
	var answer = 0;
	var cr;
	for (var i = 0 ; i < gData[p_index].nextCrossRoads.length ; i++) {
		cr = gData[p_index].nextCrossRoads[i];
		answer = Math.max(answer, longestFrom(cr.destination, p_distance + cr.distance));
	}
	return answer;
}

// --------------

// We already added the one-way paths in part 1... let's add the opposite paths now !
function init2() {
	for (var i = 0 ; i < gData.length ; i++) {
		gData[i].nextCrossRoads2 = [];
	}
	var ncr;
	for (var i = 1 ; i < gData.length ; i++) { // 1 can never be a "next cross road"
		for (var j = 0 ; j < gData[i].nextCrossRoads.length ; j++) {
			ncr = gData[i].nextCrossRoads[j].destination;
			if (ncr != gData.length-1) {				
				gData[ncr].nextCrossRoads2.push({destination : i, distance : gData[i].nextCrossRoads[j].distance});
			}
		}
	}
	for (var i = 0 ; i < gData.length ; i++) {
		for (var j = 0 ; j < gData[i].nextCrossRoads2.length ; j++) {
			gData[i].nextCrossRoads.push({destination : gData[i].nextCrossRoads2[j].destination, distance : gData[i].nextCrossRoads2[j].distance});
		}
		gData[i].nextCrossRoads2 = []; // For clarty. NOT IN THE j LOOP YOU DUMMY !
	}
}

var gTakenList = [];
function longestFromP2(p_index, p_distance) {
	if (p_index == gData.length-1) {
		//console.log(gTakenList);
		//console.log(p_distance);
		return p_distance;
	} 
	var answer = 0;
	var iCR;
	for (var i = 0 ; i < gData[p_index].nextCrossRoads.length ; i++) {
		iCR = gData[p_index].nextCrossRoads[i].destination;
		if (!gTaken[iCR]) {
			gTakenList.push(iCR);
			gTaken[iCR] = true;
			answer = Math.max(answer, longestFromP2(iCR, p_distance + gData[p_index].nextCrossRoads[i].distance));
			gTaken[iCR] = false;
			gTakenList.pop();
		}
	}
	return answer;
}

function conclusion_23_2() {
	rawData = rawDataOfficial;
	init();
	init2();
	gTaken = generateArray(gData.length, false);
	return longestFromP2(0, 0);
}